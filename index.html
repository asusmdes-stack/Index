<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå∏ –°–∞–∫—É—Ä–∞ –°—É–¥—å–±—ã</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –í–ï–°–¨ CSS INLINE! */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            background: #000;
            color: #fff;
        }

        #matrix {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .sakura-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .navbar h1 {
            font-size: 1.2rem;
            background: linear-gradient(45deg, #ff0000, #ff4444);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px #ff0000;
        }

        .stars-btn {
            background: linear-gradient(45deg, #ff0000, #ff4444);
            color: #fff;
            border: 2px solid #ff0000;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 20px #ff0000;
            transition: all 0.3s;
        }

        .stars-btn:hover {
            box-shadow: 0 0 30px #ff0000, 0 0 40px #ff0000;
            transform: scale(1.05);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 100px 1rem 2rem;
            max-width: 400px;
            margin: 0 auto;
        }

        .sakura-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            filter: drop-shadow(0 0 20px #ff0000);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 20px #ff0000); }
            to { filter: drop-shadow(0 0 30px #ff0000); }
        }

        .title {
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 2rem;
            background: linear-gradient(45deg, #ff0000, #ff4444);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        input {
            width: 100%;
            padding: 1rem;
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid #ff0000;
            border-radius: 15px;
            color: #fff;
            font-size: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .gadanie-btn {
            width: 100%;
            padding: 1.2rem;
            background: linear-gradient(45deg, #ff0000, #ff4444);
            color: #fff;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(255, 0, 0, 0.4);
            transition: all 0.3s;
        }

        .gadanie-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(255, 0, 0, 0.6);
        }

        .result {
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .hidden {
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .sakura-color {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            position: relative;
            overflow: hidden;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        #colorName {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: bold;
        }

        #poem {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            font-style: italic;
            color: #ffcccc;
        }

        #advice {
            background: rgba(255, 0, 0, 0.1);
            padding: 1rem;
            border-radius: 10px;
            border-left: 4px solid #ff0000;
        }

        .share-btn {
            margin-top: 1rem;
            background: linear-gradient(45deg, #ff4444, #ff6666);
            color: #fff;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        /* üÜï –ü–û–ü–ê–ü –î–õ–Ø –°–°–´–õ–ö–ò */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .popup-content {
            background: linear-gradient(135deg, #1a0000, #330000);
            border: 2px solid #ff0000;
            border-radius: 20px;
            padding: 2rem;
            max-width: 350px;
            width: 90%;
            text-align: center;
            box-shadow: 0 0 50px #ff0000;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .popup-overlay.active .popup-content {
            transform: scale(1);
        }

        .popup-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            filter: drop-shadow(0 0 20px #ff0000);
        }

        .popup-title {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ff0000, #ff4444);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .popup-text {
            color: #ffcccc;
            margin-bottom: 1.5rem;
            line-height: 1.4;
        }

        .close-btn {
            background: linear-gradient(45deg, #ff4444, #ff6666);
            color: #fff;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
            transition: all 0.3s;
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .close-btn:hover {
            box-shadow: 0 0 25px rgba(255, 0, 0, 0.5);
            transform: scale(1.02);
        }

        .cancel-btn {
            background: rgba(255,0,0,0.2);
            color: #fff;
            border: 1px solid #ff0000;
            width: 100%;
        }
    </style>
</head>
<body>
    <!-- –ù–ï–û–ù –ú–ê–¢–†–ò–¶–ê –§–û–ù -->
    <canvas id="matrix"></canvas>

    <!-- –ì–õ–ê–í–ù–´–ô –ö–û–ù–¢–ï–ô–ù–ï–† -->
    <div class="sakura-container">
        <!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
        <nav class="navbar">
            <h1>üå∏ –°–ê–ö–£–†–ê –°–£–î–¨–ë–´</h1>
            <button id="starsBtn" class="stars-btn">‚≠ê 10 Stars</button>
        </nav>

        <!-- –§–û–†–ú–ê -->
        <main class="main-content">
            <div class="sakura-icon">üå∏</div>
            <h2 class="title">–†–∞—Å–∫—Ä–æ–π –ª–µ–ø–µ—Å—Ç–∫–∏ —Å—É–¥—å–±—ã</h2>
            <input type="text" id="question" placeholder="–ß—Ç–æ –≤–æ–ª–Ω—É–µ—Ç –¥—É—à—É?..." maxlength="50">
            
            <!-- üÜï –ö–ù–û–ü–ö–ê –ó–ê–ú–ï–ù–ò–õ–ê –°–°–´–õ–ö–£ -->
            <button id="donateBtn" class="gadanie-btn">üî¥ –†–ê–°–ö–†–´–¢–¨ –°–ê–ö–£–†–£</button>
            
            <!-- –†–ï–ó–£–õ–¨–¢–ê–¢ -->
            <div id="result" class="result hidden">
                <div id="sakuraColor" class="sakura-color"></div>
                <h3 id="colorName"></h3>
                <p id="poem"></p>
                <p id="advice"></p>
                <button onclick="shareResult()" class="share-btn">üì± –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
            </div>
        </main>
    </div>

    <!-- üÜï –ü–û–ü–ê–ü –î–õ–Ø –î–ï–ô–¢–ê -->
    <div id="donatePopup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-icon">üå∏</div>
            <h3 class="popup-title">–ü–æ–¥–¥–µ—Ä–∂–∏ –°–∞–∫—É—Ä—É!</h3>
            <p class="popup-text">10 Stars = 1 –ì–∞–¥–∞–Ω–∏–µ<br>–†–∞—Å–∫—Ä–æ–π –ª–µ–ø–µ—Å—Ç–∫–∏ —Å—É–¥—å–±—ã!</p>
            <button class="close-btn" onclick="openDonateLink()">‚≠ê –û–ü–õ–ê–¢–ò–¢–¨ 10 STARS</button>
            <button class="close-btn cancel-btn" onclick="closePopup()">‚ùå –û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <!-- JS INLINE -->
    <script>
        // –í–ï–°–¨ JS INLINE!
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        window.Telegram.WebApp.ready();
        window.Telegram.WebApp.expand();

        // –ú–ê–¢–†–ò–¶–ê –ù–ï–û–ù
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const matrix = "„Çµ„ÇØ„É©„Éè„Éä„Éü".repeat(50).split("");
        const fontSize = 14;
        const columns = canvas.width / fontSize;
        const drops = Array(Math.floor(columns)).fill(1);

        function drawMatrix() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#ff0000';
            ctx.font = fontSize + 'px monospace';
            
            drops.forEach((y, i) => {
                const text = matrix[Math.floor(Math.random() * matrix.length)];
                ctx.fillText(text, i * fontSize, y * fontSize);
                
                if (y * fontSize > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i]++;
            });
        }

        setInterval(drawMatrix, 50);

        // 6 –¶–í–ï–¢–û–í –°–ê–ö–£–†–´
        const sakuraColors = [
            { color: '#ffffff', name: 'üå∏ –ë–µ–ª–∞—è', poem: '–í —Ç–∏—à–∏–Ω–µ –Ω–æ—á–Ω–æ–π, –ª–µ–ø–µ—Å—Ç–∫–∏ —á–∏—Å—Ç—ã,', advice: '–°–µ—Ä–¥—Ü–µ —Å–≤–æ–±–æ–¥–Ω–æ. –ù–æ–≤—ã–µ –≤—Å—Ç—Ä–µ—á–∏ –∂–¥—É—Ç —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π!' },
            { color: '#ff69b4', name: 'üå∑ –†–æ–∑–æ–≤–∞—è', poem: '–ü–æ–¥ –ª—É–Ω–æ–π —Ü–≤–µ—Ç—ã –ª—é–±–≤–∏ —Ä–∞—Å—Ü–≤–µ—Ç–∞—é—Ç,', advice: '–°—Ç—Ä–∞—Å—Ç—å –±–ª–∏–∑–∫–æ! –í—Å—Ç—Ä–µ—á–∞ —Å —Å—É–¥—å–±–æ–π –≤ –±–ª–∏–∂–∞–π—à–∏–µ 3 –¥–Ω—è!' },
            { color: '#ff0000', name: 'üå∫ –ö—Ä–∞—Å–Ω–∞—è', poem: '–û–≥–æ–Ω—å —Å—Ç—Ä–∞—Å—Ç–∏ –≤ –ª–µ–ø–µ—Å—Ç–∫–∞—Ö –ø—ã–ª–∞–µ—Ç,', advice: '–ñ–µ–ª–∞–Ω–∏—è –∏—Å–ø–æ–ª–Ω—è—Ç—Å—è! –î–µ–π—Å—Ç–≤—É–π —Å–º–µ–ª–æ —Å–µ–≥–æ–¥–Ω—è!' },
            { color: '#8a2be2', name: 'ü•Ä –§–∏–æ–ª–µ—Ç–æ–≤–∞—è', poem: '–¢–∞–π–Ω—ã –Ω–æ—á–∏ –≤ —Ü–≤–µ—Ç–∞—Ö —Å–∫—Ä—ã—Ç—ã,', advice: '–°–µ–∫—Ä–µ—Ç –æ—Ç–∫—Ä–æ–µ—Ç—Å—è. –î–æ–≤–µ—Ä—è–π –∏–Ω—Ç—É–∏—Ü–∏–∏ –±–ª–∏–∂–∞–π—à–∏–µ 5 –¥–Ω–µ–π!' },
            { color: '#ffd700', name: 'üíõ –ñ—ë–ª—Ç–∞—è', poem: '–°–æ–ª–Ω—Ü–µ —Å—á–∞—Å—Ç—å—è –≤ –ª–µ–ø–µ—Å—Ç–∫–∞—Ö —Å–∏—è–µ—Ç,', advice: '–£–¥–∞—á–∞ —Ä—è–¥–æ–º! –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø—Ä–æ—Ä—ã–≤ —á–µ—Ä–µ–∑ 10 –¥–Ω–µ–π!' },
            { color: '#4169e1', name: 'üåº –°–∏–Ω—è—è', poem: '–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –≤–æ–¥ –≤ —Ü–≤–µ—Ç–∞—Ö —Ç–∞–∏—Ç—Å—è,', advice: '–í—Ä–µ–º—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π. –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç —á–µ—Ä–µ–∑ 14 –¥–Ω–µ–π.' }
        ];

        // –ê–ù–ê–õ–ò–ó –í–û–ü–†–û–°–ê
        function analyzeQuestion(question) {
            const love = ['–ª—é–±–æ–≤—å', '–ø–∞—Ä–µ–Ω—å', '–¥–µ–≤—É—à–∫–∞', '—á—É–≤—Å—Ç–≤–∞', '–æ—Ç–Ω–æ—à–µ–Ω–∏—è'];
            const money = ['–¥–µ–Ω—å–≥–∏', '—Ä–∞–±–æ—Ç–∞', '–∫–∞—Ä—å–µ—Ä–∞', '–±–∏–∑–Ω–µ—Å'];
            const health = ['–∑–¥–æ—Ä–æ–≤—å–µ', '–±–æ–ª–µ–∑–Ω—å', '—ç–Ω–µ—Ä–≥–∏—è'];
            
            if (love.some(w => question.toLowerCase().includes(w))) return 1;
            if (money.some(w => question.toLowerCase().includes(w))) return 4;
            if (health.some(w => question.toLowerCase().includes(w))) return 5;
            return Math.floor(Math.random() * 6);
        }

        // üÜï –§–£–ù–ö–¶–ò–ò –ü–û–ü–ê–ü–ê
        function showPopup() {
            document.getElementById('donatePopup').classList.add('active');
            window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
        }

        function closePopup() {
            document.getElementById('donatePopup').classList.remove('active');
            window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
        }

        function openDonateLink() {
            closePopup();
            window.Telegram.WebApp.openTelegramLink('https://t.me/ExpresRoBot?start=donate');
        }

        // üÜï –ö–ù–û–ü–ö–ê –ì–ê–î–ê–ù–ò–Ø - –ü–û–ö–ê–ó–´–í–ê–ï–¢ –ü–û–ü–ê–ü
        document.getElementById('donateBtn').onclick = () => {
            const question = document.getElementById('question').value.trim();
            if (!question) {
                alert('‚ùì –ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å!');
                return;
            }
            showPopup(); // –ü–û–ö–ê–ó–´–í–ê–ï–ú –ü–û–ü–ê–ü
        };

        // üÜï –ó–ê–ö–†–´–¢–ò–ï –ü–û–ü–ê–ü–ê –ö–õ–ò–ö–û–ú –ù–ê –§–û–ù
        document.getElementById('donatePopup').onclick = (e) => {
            if (e.target.id === 'donatePopup') closePopup();
        };

        // STARS –ö–ù–û–ü–ö–ê
        document.getElementById('starsBtn').onclick = () => {
            window.Telegram.WebApp.openTelegramLink('https://t.me/ExpresRoBot?start=donate');
        };

        // SHOW RESULT (–ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã - –≤—Ä—É—á–Ω—É—é –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–ª–∏ —á–µ—Ä–µ–∑ webhook)
        function showSakuraResult(question) {
            const colorIndex = analyzeQuestion(question);
            const color = sakuraColors[colorIndex];
            
            document.getElementById('sakuraColor').style.background = color.color;
            document.getElementById('colorName').textContent = color.name;
            document.getElementById('poem').textContent = color.poem;
            document.getElementById('advice').textContent = color.advice;
            document.getElementById('result').classList.remove('hidden');
            
            window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
        }

        // SHARE
        function shareResult() {
            const user = window.Telegram.WebApp.initDataUnsafe.user;
            const colorName = document.getElementById('colorName').textContent;
            const poem = document.getElementById('poem').textContent;
            const text = `üå∏ –ú–æ—è –°–∞–∫—É—Ä–∞ –°—É–¥—å–±—ã: ${colorName}\n"${poem}"\n\n–ü–æ–ø—Ä–æ–±—É–π —Å–≤–æ—ë! t.me/${user.username}`;
            
            window.Telegram.WebApp.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(window.Telegram.WebApp.initDataUnsafe.start_param)}&text=${encodeURIComponent(text)}`);
        }
    </script>
</body>
</html>
